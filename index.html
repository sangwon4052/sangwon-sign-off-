<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>광주대학교 총동문회</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    /* 기존 스타일 유지 및 추가 */
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Nanum Gothic',sans-serif;background:#f0f6fb;min-height:100vh;color:#333}
    .container{max-width:1100px;margin:0 auto;padding:0 24px}
    header{background:linear-gradient(90deg,#e8f4fc 0%,#f0faee 100%);box-shadow:0 2px 16px rgba(78,163,216,0.13);position:sticky;top:0;z-index:100;border-bottom:2px solid #b8d8f0}
    .header-inner{display:flex;justify-content:space-between;align-items:center;height:68px}
    .logo-wrap{display:flex;align-items:center;gap:10px;text-decoration:none}
    .logo-circle{width:40px;height:40px;background:#1a3a6b;border-radius:50%;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:800;font-size:18px;box-shadow:0 3px 6px rgba(0,0,0,0.1)}
    .logo-text{font-family:'Nanum Myeongjo',serif;font-weight:800;font-size:22px;color:#1a3a6b;letter-spacing:-0.5px}
    nav ul{display:flex;list-style:none;gap:30px}
    nav ul li a{text-decoration:none;color:#4a607d;font-weight:700;font-size:15px;transition:0.2s}
    nav ul li a:hover, nav ul li a.active{color:#1a3a6b;border-bottom:2px solid #1a3a6b;padding-bottom:5px}
    .btn-admin{background:#fff;border:1px solid #c2d6e8;padding:6px 14px;border-radius:6px;font-size:13px;color:#5a7b9c;cursor:pointer;font-weight:600}
    
    .hero{background:#fff;padding:40px 0;border-bottom:1px solid #e2edf7}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}
    .stat-card{background:#fff;padding:25px;border-radius:16px;box-shadow:0 10px 25px rgba(184,216,240,0.2);text-align:center;border:1px solid #eef6fd}
    .stat-label{font-size:14px;color:#7a8fa9;margin-bottom:8px;font-weight:600}
    .stat-value{font-size:28px;font-weight:800;color:#1a3a6b}
    .stat-value span{font-size:16px;margin-left:4px;color:#5a7b9c}

    .section{display:none;padding:40px 0;animation:fadeIn 0.4s ease-out}
    .section.active{display:block}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    
    .card{background:#fff;border-radius:16px;padding:30px;box-shadow:0 8px 20px rgba(0,0,0,0.03);margin-bottom:24px;border:1px solid #eef4f9}
    h2.sec-title{font-size:24px;margin-bottom:25px;color:#1a3a6b;display:flex;align-items:center;gap:10px;font-family:'Nanum Myeongjo',serif;font-weight:800}
    h2.sec-title::before{content:'';display:inline-block;width:6px;height:24px;background:#1a3a6b;border-radius:3px}

    /* 기부 폼 스타일 */
    .form-group{margin-bottom:18px}
    .form-group label{display:block;margin-bottom:8px;font-weight:700;font-size:14px;color:#4a607d}
    .form-control{width:100%;padding:12px 16px;border:1px solid #dce7f2;border-radius:8px;font-size:14px;outline:none;transition:0.2s}
    .form-control:focus{border-color:#1a3a6b;box-shadow:0 0 0 3px rgba(26,58,107,0.1)}
    .btn-submit{background:#1a3a6b;color:#fff;border:none;padding:14px 28px;border-radius:8px;font-weight:700;cursor:pointer;width:100%;font-size:16px}
    
    .file-list-table{width:100%;border-collapse:collapse}
    .file-list-table th{background:#f5f9fd;padding:12px;text-align:left;border-bottom:2px solid #deeef8;font-size:14px;color:#5a7b9c}
    .file-list-table td{padding:12px;border-bottom:1px solid #eff4f9;font-size:14px}
    .btn-download{background:#e8f4fc;color:#1a3a6b;padding:4px 10px;border-radius:4px;text-decoration:none;font-size:12px;font-weight:700}

    .hidden { display: none !important; }
  </style>
</head>
<body>

<header>
  <div class="container header-inner">
    <a href="#" class="logo-wrap" onclick="showSection('home')">
      <div class="logo-circle">G</div>
      <div class="logo-text">광주대학교 총동문회</div>
    </a>
    <nav>
      <ul>
        <li><a href="#" id="nav-home" onclick="showSection('home')">홈</a></li>
        <li><a href="#" id="nav-intro" onclick="showSection('intro')">총동문회</a></li>
        <li><a href="#" id="nav-join" onclick="showSection('join')">회원가입</a></li>
        <li><a href="#" id="nav-dir" onclick="showSection('dir')">회원명부</a></li>
      </ul>
    </nav>
    <button class="btn-admin" id="admin-btn" onclick="toggleAdmin()">관리자 로그인</button>
  </div>
</header>

<main class="container">
  <section id="home" class="section active">
    <div class="hero">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">가입 동문</div>
          <div class="stat-value"><span id="total-members">0</span><span>명</span></div>
        </div>
        <div class="stat-card">
          <div class="stat-label">누적 기부금</div>
          <div class="stat-value"><span id="total-donations">0</span><span>원</span></div>
        </div>
      </div>

      <div class="card">
        <h2 class="sec-title">회장 인사말</h2>
        <div id="home-greeting">광주대학교 총동문회 홈페이지 방문을 환영합니다.</div>
      </div>
      
      <div class="card">
        <h2 class="sec-title">동문기부 신청</h2>
        <p style="margin-bottom:20px; color:#666; font-size:14px;">모교와 후배 사랑을 위한 기부 행렬에 동참해 주세요.</p>
        <div style="max-width:600px; margin:0 auto;">
          <div class="form-group">
            <label>학과</label>
            <input type="text" id="don-dept" class="form-control" placeholder="예: 경영학과">
          </div>
          <div class="form-group">
            <label>성명</label>
            <input type="text" id="don-name" class="form-control" placeholder="성명을 입력하세요">
          </div>
          <div class="form-group">
            <label>기부금액 (원)</label>
            <input type="number" id="don-amount" class="form-control" placeholder="숫자만 입력">
          </div>
          <div class="form-group">
            <label>영수증 구분</label>
            <select id="don-type" class="form-control" onchange="toggleDonFields()">
              <option value="cash">현금 (개인)</option>
              <option value="receipt">영수증 (사업자)</option>
            </select>
          </div>
          <div id="don-field-cash" class="form-group">
            <label>휴대폰번호</label>
            <input type="text" id="don-phone" class="form-control" placeholder="010-0000-0000">
          </div>
          <div id="don-field-biz" class="form-group hidden">
            <label>사업자번호</label>
            <input type="text" id="don-bizno" class="form-control" placeholder="000-00-00000">
            <label style="margin-top:10px">이메일</label>
            <input type="email" id="don-email" class="form-control" placeholder="example@mail.com">
          </div>
          <button class="btn-submit" onclick="submitDonation()">기부 신청하기</button>
        </div>
      </div>
    </div>
  </section>

  <section id="intro" class="section">
    <div style="display:flex; gap:10px; margin-bottom:20px;">
      <button class="btn-admin" onclick="showIntroTab('greet')">회장 인사말</button>
      <button class="btn-admin" onclick="showIntroTab('org')">조직도/이사회</button>
      <button class="btn-admin" onclick="showIntroTab('files')">회의록/업무추진비</button>
    </div>
    
    <div id="tab-greet" class="intro-tab card">
      <h2 class="sec-title">회장 인사말</h2>
      <div id="view-greeting-img"></div>
      <div id="view-greeting-text"></div>
    </div>
    
    <div id="tab-org" class="intro-tab card hidden">
      <h2 class="sec-title">조직도 및 이사회</h2>
      <div id="view-org-img" style="text-align:center;"></div>
    </div>

    <div id="tab-files" class="intro-tab card hidden">
      <h2 class="sec-title">회의록 및 업무추진비</h2>
      <table class="file-list-table">
        <thead>
          <tr>
            <th>구분</th>
            <th>제목/내용</th>
            <th>날짜</th>
            <th>파일</th>
          </tr>
        </thead>
        <tbody id="file-list-body">
          </tbody>
      </table>
    </div>
  </section>

  <section id="admin-panel" class="section card" style="border:2px solid #1a3a6b">
    <h2 class="sec-title">관리자 제어판</h2>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
      <div class="card" style="background:#f9fbff">
        <h3>회의록/업무추진비 등록</h3>
        <div class="form-group">
          <label>구분</label>
          <select id="admin-file-type" class="form-control">
            <option value="minutes">회의록</option>
            <option value="expenses">업무추진비</option>
          </select>
        </div>
        <div class="form-group">
          <label>제목/내용</label>
          <input type="text" id="admin-file-title" class="form-control">
        </div>
        <div class="form-group">
          <label>파일 첨부</label>
          <input type="file" id="admin-file-input" class="form-control">
        </div>
        <button class="btn-submit" onclick="uploadAdminFile()">업로드 및 저장</button>
      </div>
      
      <div class="card" style="background:#f9fbff">
        <h3>동문기부 내역</h3>
        <div id="admin-donation-list" style="font-size:12px; max-height:300px; overflow-y:auto;">
          </div>
      </div>
    </div>
    <button class="btn-admin" style="margin-top:20px" onclick="showSection('home')">나가기</button>
  </section>
  
  </main>

<script>
/** 데이터 초기화 **/
let state = {
  members: JSON.parse(localStorage.getItem('gj_members') || '[]'),
  donations: JSON.parse(localStorage.getItem('gj_donations') || '[]'),
  files: JSON.parse(localStorage.getItem('gj_files') || '[]'), // 회의록, 업무추진비 통합
  isAdmin: false
};

const ADMIN_ID = "office2024";
const ADMIN_PW = "gjuniv!2024";

/** 초기 렌더링 **/
window.onload = () => {
  renderHome();
  renderFileList();
};

/** 섹션 전환 **/
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  
  document.querySelectorAll('nav ul li a').forEach(a => a.classList.remove('active'));
  const navItem = document.getElementById('nav-' + id);
  if(navItem) navItem.classList.add('active');

  if(id === 'home') renderHome();
  if(id === 'intro') showIntroTab('greet');
}

/** 홈 화면 정보 업데이트 **/
function renderHome() {
  document.getElementById('total-members').textContent = state.members.length.toLocaleString();
  const totalDonation = state.donations.reduce((sum, d) => sum + Number(d.amount), 0);
  document.getElementById('total-donations').textContent = totalDonation.toLocaleString();
}

/** 기부 신청 관련 **/
function toggleDonFields() {
  const type = document.getElementById('don-type').value;
  if(type === 'cash') {
    document.getElementById('don-field-cash').classList.remove('hidden');
    document.getElementById('don-field-biz').classList.add('hidden');
  } else {
    document.getElementById('don-field-cash').classList.add('hidden');
    document.getElementById('don-field-biz').classList.remove('hidden');
  }
}

function submitDonation() {
  const dept = document.getElementById('don-dept').value;
  const name = document.getElementById('don-name').value;
  const amount = document.getElementById('don-amount').value;
  const type = document.getElementById('don-type').value;
  
  if(!dept || !name || !amount) return alert('필수 항목을 모두 입력하세요.');

  const newDonation = {
    id: Date.now(),
    dept, name, amount, type,
    phone: document.getElementById('don-phone').value,
    bizno: document.getElementById('don-bizno').value,
    email: document.getElementById('don-email').value,
    date: new Date().toLocaleDateString()
  };

  state.donations.push(newDonation);
  localStorage.setItem('gj_donations', JSON.stringify(state.donations));
  alert('기부 신청이 완료되었습니다. 감사합니다!');
  
  // 입력창 초기화
  ['don-dept','don-name','don-amount','don-phone','don-bizno','don-email'].forEach(id => {
    document.getElementById(id).value = '';
  });
  renderHome();
}

/** 관리자 기능: 파일 업로드 **/
function uploadAdminFile() {
  const type = document.getElementById('admin-file-type').value;
  const title = document.getElementById('admin-file-title').value;
  const fileInput = document.getElementById('admin-file-input');
  
  if(!title || !fileInput.files[0]) return alert('제목과 파일을 확인하세요.');

  const file = fileInput.files[0];
  const reader = new FileReader();
  
  reader.onload = function(e) {
    const fileData = {
      id: Date.now(),
      type: type === 'minutes' ? '회의록' : '업무추진비',
      title: title,
      fileName: file.name,
      fileContent: e.target.result, // Base64 데이터
      date: new Date().toLocaleDateString()
    };
    
    state.files.push(fileData);
    localStorage.setItem('gj_files', JSON.stringify(state.files));
    alert('파일이 업로드되었습니다.');
    renderFileList();
    fileInput.value = '';
    document.getElementById('admin-file-title').value = '';
  };
  
  reader.readAsDataURL(file);
}

/** 회원 화면: 파일 목록 렌더링 **/
function renderFileList() {
  const tbody = document.getElementById('file-list-body');
  if(!tbody) return;
  
  tbody.innerHTML = state.files.map(f => `
    <tr>
      <td><span style="background:#eee; padding:2px 6px; border-radius:4px; font-size:12px;">${f.type}</span></td>
      <td style="font-weight:700">${f.title}</td>
      <td style="color:#888">${f.date}</td>
      <td>
        <a href="${f.fileContent}" download="${f.fileName}" class="btn-download">다운로드</a>
      </td>
    </tr>
  `).join('');
  if(state.files.length === 0) tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; padding:30px; color:#999;">등록된 자료가 없습니다.</td></tr>';
}

/** 총동문회 탭 전환 **/
function showIntroTab(tabId) {
  document.querySelectorAll('.intro-tab').forEach(t => t.classList.add('hidden'));
  document.getElementById('tab-' + tabId).classList.remove('hidden');
  if(tabId === 'files') renderFileList();
}

/** 관리자 로그인 **/
function toggleAdmin() {
  if(state.isAdmin) {
    state.isAdmin = false;
    alert('로그아웃 되었습니다.');
    showSection('home');
    document.getElementById('admin-btn').textContent = "관리자 로그인";
    return;
  }
  const id = prompt("관리자 아이디:");
  const pw = prompt("비밀번호:");
  if(id === ADMIN_ID && pw === ADMIN_PW) {
    state.isAdmin = true;
    alert('관리자로 로그인되었습니다.');
    document.getElementById('admin-btn').textContent = "관리자 로그아웃";
    showSection('admin-panel');
    renderAdminDonations();
  } else {
    alert('정보가 일치하지 않습니다.');
  }
}

function renderAdminDonations() {
  const list = document.getElementById('admin-donation-list');
  list.innerHTML = state.donations.map(d => `
    <div style="border-bottom:1px solid #ddd; padding:8px 0;">
      <b>${d.name}</b> (${d.dept}) - ${Number(d.amount).toLocaleString()}원<br>
      <span style="color:#666">${d.type === 'cash' ? '현금:'+d.phone : '사업자:'+d.bizno+' / '+d.email}</span>
    </div>
  `).join('') || '기부 내역이 없습니다.';
}
</script>

</body>
</html>